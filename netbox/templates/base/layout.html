{# Base layout for the core NetBox UI w/navbar and page content #}
{% extends 'base/base.html' %}
{% load helpers %}
{% load navigation %}
{% load static %}
{% load i18n %}

{% comment %}
Blocks:
  header: Page header
  tabs: Horizontal navigation tabs
  content: Page content
  modals: Bootstrap 5 modal components
{% endcomment %}

{% block layout %}

  <div class="page">

    {# Sidebar #}
    <aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
      <div class="container-fluid">

        {# Header icon #}
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <h1 class="navbar-brand navbar-brand-autodark">
          <a href="{% url 'home' %}">
            <img src="{% static 'netbox_logo.svg' %}" height="32" alt="{% trans "NetBox Logo" %}" class="navbar-brand-image">
          </a>
        </h1>

        {# Navigation menu #}
        <div class="collapse navbar-collapse" id="sidebar-menu">
          {% nav %}
        </div>

      </div>
    </aside>

    {# Top menu #}
    <header class="navbar navbar-expand-md d-none d-lg-flex d-print-none">
      <div class="container-xl">

        {# Toggle button #}
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-nav flex-row order-md-last">
          <div class="d-none d-md-flex">
            <a href="?theme=dark" class="nav-link px-0 hide-theme-dark" title="Enable dark mode" data-bs-toggle="tooltip" data-bs-placement="bottom">
              <!-- Download SVG icon from http://tabler-icons.io/i/moon -->
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg>
            </a>
            <a href="?theme=light" class="nav-link px-0 hide-theme-light" title="Enable light mode" data-bs-toggle="tooltip" data-bs-placement="bottom">
              <!-- Download SVG icon from http://tabler-icons.io/i/sun -->
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" /></svg>
            </a>
            <div class="nav-item dropdown d-none d-md-flex me-3">
              <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                <!-- Download SVG icon from http://tabler-icons.io/i/bell -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" /><path d="M9 17v1a3 3 0 0 0 6 0v-1" /></svg>
                <span class="badge bg-red"></span>
              </a>
              <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
                <div class="card">
                  <div class="card-header">
                    <h3 class="card-title">Last updates</h3>
                  </div>
                  <div class="list-group list-group-flush list-group-hoverable">
                    <div class="list-group-item">
                      Item 1
                    </div>
                    <div class="list-group-item">
                      Item 2
                    </div>
                    <div class="list-group-item">
                      Item 3
                    </div>
                    <div class="list-group-item">
                      Item 4
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {# User menu #}
          {% include 'inc/profile_button.html' %}
        </div>

        {# Search box #}
        <div class="collapse navbar-collapse" id="navbar-menu">
          <form action="{% url 'search' %}" method="get" autocomplete="off" novalidate>
            <div class="input-icon">
              {# TODO: Use standard icon #}
              <span class="input-icon-addon">
                <!-- Download SVG icon from http://tabler-icons.io/i/search -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
                  <path d="M21 21l-6 -6" />
                </svg>
              </span>
              <input type="text" name="q" value="" class="form-control" placeholder="Searchâ€¦" aria-label="Search NetBox">
            </div>
          </form>
        </div>

      </div>
    </header>

    {# Page content #}
    <div class="page-wrapper">

      {# Page header #}
      <div class="container-xl mt-2 d-print-none">
        {% if config.BANNER_TOP %}
          <div class="text-center mx-3">
            {{ config.BANNER_TOP|safe }}
          </div>
        {% endif %}

        {% if settings.DEBUG and not settings.DEVELOPER %}
          <div class="alert alert-warning text-center mx-3" role="alert">
            <strong><i class="mdi mdi-alert"></i> {% trans "Debug mode is enabled" %}.</strong>
            {% trans "Performance may be limited. Debugging should never be enabled on a production system" %}.
          </div>
        {% endif %}

        {% if config.MAINTENANCE_MODE and config.BANNER_MAINTENANCE %}
          <div class="alert alert-warning text-center mx-3" role="alert">
            <h5><i class="mdi mdi-alert"></i> {% trans "Maintenance Mode" %}</h5>
            {{ config.BANNER_MAINTENANCE|escape }}
          </div>
        {% endif %}

        {% block header %}
          <div class="row align-items-center">

            {# Title #}
            <div class="col">
              <h2 class="page-title mb-1">{% block title %}{% endblock title %}</h2>
              {% block subtitle %}{% endblock %}
            </div>

            {# Controls #}
            <div class="col-auto d-print-none">
              {% block controls %}{% endblock controls %}
            </div>

          </div>
        {% endblock header %}
      </div>
      {# /Page header #}

      {# Page body #}
      <div class="page-body">
        <div class="container-xl">
          {% block tabs %}{% endblock %}
          {# TODO: Remove content-wrapper block #}
          {% block content-wrapper %}
              {% block content %}{% endblock %}
          {% endblock %}
          {# Bottom banner #}
          {% if config.BANNER_BOTTOM %}
            <div class="text-center mx-3">
              {{ config.BANNER_BOTTOM|safe }}
            </div>
          {% endif %}
        </div>
      </div>
      {# /Page body #}

      {# Page footer #}
      <footer class="footer footer-transparent d-print-none">
        <div class="container-xl">
          {% block footer %}
            <div class="row text-center align-items-center flex-row-reverse">
              <div class="col-lg-auto ms-lg-auto">
                <ul class="list-inline list-inline-dots mb-0">
                  {% block footer_links %}
                    {# Documentation #}
                    <li class="list-inline-item">
                      <a href="{% static 'docs/' %}" target="_blank" class="link-secondary" rel="noopener">
                        <i title="{% trans "Docs" %}" class="mdi mdi-book-open-variant text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                      </a>
                    </li>
                    {# REST API #}
                    <li class="list-inline-item">
                      <a href="{% url 'api-root' %}" target="_blank" class="link-secondary" rel="noopener">
                        <i title="{% trans "REST API" %}" class="mdi mdi-cloud-braces text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                      </a>
                    </li>
                    {# API docs #}
                    <li class="list-inline-item">
                      <a href="{% url 'api_docs' %}" target="_blank" class="link-secondary" rel="noopener">
                        <i title="{% trans "REST API documentation" %}" class="mdi mdi-book text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                      </a>
                    </li>
                    {# GraphQL API #}
                    {% if config.GRAPHQL_ENABLED %}
                      <li class="list-inline-item">
                        <a href="{% url 'graphql' %}" target="_blank" class="link-secondary" rel="noopener">
                          <i title="{% trans "GraphQL API" %}" class="mdi mdi-graphql text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                        </a>
                      </li>
                    {% endif %}
                    {# GitHub #}
                    <li class="list-inline-item">
                      <a href="https://github.com/netbox-community/netbox" target="_blank" class="link-secondary" rel="noopener">
                        <i title="{% trans "Source Code" %}" class="mdi mdi-github text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                      </a>
                    </li>
                    {# NetDev Slack #}
                    <li class="list-inline-item">
                      <a href="https://netdev.chat" target="_blank" class="link-secondary" rel="noopener">
                        <i title="{% trans "Community" %}" class="mdi mdi-slack text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>
                      </a>
                    </li>
                  {% endblock footer_links %}
                </ul>
              </div>
              <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                <ul class="list-inline list-inline-dots mb-0">
                  <li class="list-inline-item">
                    {% annotated_now %} {% now 'T' %}
                  </li>
                  <li class="list-inline-item">
                    <a href="./changelog.html" class="link-secondary" rel="noopener">
                      {{ settings.HOSTNAME }} (v{{ settings.VERSION }})
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          {% endblock footer %}
        </div>
      </footer>
      {# /Page footer #}

    {# /Page content #}
    </div>

    {# BS5 pop-up modals #}
    {% block modals %}{% endblock %}

  </div>
{% endblock layout %}
