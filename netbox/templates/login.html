{# User login page. Extends base.html directly to override normal UI layout. #}
{% extends 'base/base.html' %}
{% load form_helpers %}
{% load static %}
{% load i18n %}

{% block layout %}

  <div class="page page-center">
    <div class="container container-tight py-4">

      {# NetBox logo #}
      <div class="text-center mb-4">
        <img src="{% static 'netbox_logo.svg' %}" height="80" alt="{% trans "NetBox logo" %}" />
      </div>

      {# Login banner #}
      {% if config.BANNER_LOGIN %}
        <div class="mb-5 text-center">
          {{ config.BANNER_LOGIN|safe }}
        </div>
      {% endif %}

      {# Login form errors #}
      {% if form.non_field_errors %}
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">{% trans "Errors" %}</h4>
          <p>
            {{ form.non_field_errors }}
          </p>
        </div>
      {% endif %}

      <div class="card card-md">
        <div class="card-body">
          <h3 class="text-center mb-4">Log In</h3>

          {# Login form #}
          <form action="{% url 'login' %}" method="post">
            {% csrf_token %}

            {# Set post-login URL #}
            {% if 'next' in request.GET %}
              <input type="hidden" name="next" value="{{ request.GET.next }}" />
            {% elif 'next' in request.POST %}
              <input type="hidden" name="next" value="{{ request.POST.next }}" />
            {% endif %}

            {{ form }}

            <button type="submit" class="btn btn-primary btn-lg w-100 mt-4">
              {% trans "Sign In" %}
            </button>
          </form>
        </div>

        {# SSO login #}
        {% if auth_backends %}
          <div class="hr-text">or</div>
          <div class="card-body">
            <h6 class="mt-4 mb-3">{% trans "Or use a single sign-on (SSO) provider" %}:</h6>
            {% for backend in auth_backends %}
              <h5>
                {% if backend.icon_name %}<i class="mdi mdi-{{ backend.icon_name }}"></i>{% endif %}
                <a href="{{ backend.url }}" class="my-2">{{ backend.display_name }}</a>
              </h5>
            {% endfor %}
          </div>
        {% endif %}

      </div>

    </div>
  </div>

{% endblock layout %}
